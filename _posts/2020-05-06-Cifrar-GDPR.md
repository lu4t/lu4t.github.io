---
layout: post
title: Cifrar, o no encriptar.
subtitle: Las cosas de la RGPD
gh-repo: lu4t/lu4t.github.io
gh-badge: [star, follow]
tags: [Security]
comments: true
---

En la normativa GDPR el término cifrado (encryption) aparece mencionado exáctamente en 4 ocasiones:

en el considerando 83: “… el responsable o el encargado deben evaluar los riesgos inherentes al tratamiento y aplicar medidas para mitigarlos, como el cifrado. …”;

en el artículo 6, apartado 4-e: “… la existencia de garantías adecuadas, que podrán incluir el cifrado o la seudonimización…”;

también en el artículo 32, apartado 1-a: “… el responsable y el encargado del tratamiento aplicarán medidas técnicas y organizativas apropiadas para garantizar un nivel de seguridad adecuado al riesgo, que en su caso incluya, entre otros: a) la seudonimización y el cifrado de datos personales…”;

y por último en el artículo 34, 3-a: “… la comunicación al interesado a que se refiere el apartado 1 no será necesaria si se cumple alguna de las condiciones siguientes: a) el responsable del tratamiento ha adoptado medidas de protección técnicas y organizativas apropiadas y estas medidas se han aplicado a los datos personales afectados por la violación de la seguridad de los datos personales, en particular aquellas que hagan ininteligibles los datos personales para cualquier persona que no esté autorizada a acceder a ellos, como el cifrado…”

Esta entrada de mi blog no es un artículo técnico, creo que es mucho más útil hablar de los aspectos no-técnicos que afectan a la encriptación (cifrado), en el contexto del RGPD (Reglamento General de Protección de Datos, la famosa GDPR en inglés).

La protección de datos, sean del tipo que sean, en muchas ocasiones deriva en conversaciones de carácter técnico; en otras muchas ocasiones, en conversaciones de tipo legal, normativo, o de proceso. Tampoco quiero abordarlo desde esos puntos de vista. Pretendo que sea una reflexión práctica de en qué contextos (pocos) debemos plantearnos aplicar el cifrado vinculado al cumplimiento de GDPR, y siempre desde un punto de vista práctico.

Conviene empezar recalcando algo que salta a la vista de la simple lectura de los artículos de la GDPR del inicio: la norma no nos obliga a cifrar los datos para protegerlos, en ningún caso. Más bien al contrario. Lo que sí es cierto es que el cifrado de datos como estrategia sobre la que basar nuestro marco de trabajo en el tratamiento de los datos, nos va a preparar para que el grado de cumplimiento de partida de las normativas más exigentes de la industria sea elevado. Pero como todo en la vida, esto tiene un coste que no sólo es económico. Si el término cifrado aparece 4 veces mencionado en la norma, el término riesgo aparece en 73; la aplicación de una determinada técnica se aconseja o no en función del impacto que tenga en términos de riesgo, y lo cierto es que el cifrado puede que no disminuya el riesgo sino que lo incremente. Lo veremos más adelante.

Las terminología técnica como “cifrado”, conviene contextualizarla cuando la usamos. En lo relativo al cumplimiento de una normativa, si citamos el término cifrado debemos aclarar si está referido a los datos en tránsito, o en reposo; y si es en reposo, ¿hablamos de en disco o en memoria?… En general, en las normativas, estos términos técnicos se emplean de una manera generalizada. En GDPR por tanto, deberíamos entender el cifrado en el sentido más ámplio de la palabra: cuando hablan de cifrado, lo más prudente es pensar que hablan de cifrado extremo-a-extremo. Cualquier solución que nos propongamos adoptar en este contexto, debe incorporar respuestas a las preguntas que vamos a presentar a continuación, independientemente de dónde y en qué estado se encuentran los datos a proteger.

El cifrado es un término que se aplica al proceso mediante el cual un dato se convierte en una versión codificada e ininteligible de sí mismo, al aplicarse sobre él unos algoritmos que emplean unas claves de encriptación, de forma que el dato original no puede ser conocido por otro actor salvo que éste emplee una clave de descifrado que lo vuelva a su estado original (estas claves para cifrar y descifrar, en determinados tipos y técnicas de cifrado, pueden ser la misma).

Con la aparición de la normativa GDPR, el cifrado se convirtió en uno de las opciones más consideradas por muchas organizaciones. Probablemente tuvo mucho que ver la gran labor de ventas y marketing de muchos fabricantes de este tipo de soluciones. Se convirtió de la noche a la mañana en una de las medidas de seguridad para los datos favoritas, pero o cierto es que muy pocos las llegaron a implementar, y por muy bueno motivos como explicaremos a continuación.

Ya no recuerdo si fue antes, después, o al mismo tiempo que llegó la explosión del GDPR a nuestras vidas, se estaba produciendo la adopción masiva de plataformas Servicios de Cloud Computing, y esto también influyó mucho en que el término cifrado estuviese en boca de muchos. Ni qué decir tiene que los grandes proveedores de servicios Cloud usaron el término como argumento que demuestra la seguridad de sus servicios, y ayudarles a derribar así las posibles barreras y miedos que potenciales clientes pudieran tener a la hora de portar sus datos a estos nuevos CPDs y hacer uso de sus servicios. Este otro punto de vista no es objeto de mi reflexión, aunque sin duda da para otro artículo.

Como ya hemos dicho, bajo GDPR en ningún caso es obligatorio implementar ninguna técnica de cifrado. Y no sólo eso; mucho menos dice qué tipo de algoritmos o niveles de cifrado, dónde aplicarlos (si en datos en reposo, datos en uso, datos en tránsito…), o para qué tipos de datos (de carácter personal, datos sensibles, reservados, confidenciales…). Tampoco dice que se deba aplicar, o no, dependiendo del tipo de uso que se le vaya a dar a los datos.

La GDPR, y las normativas que se han publicado con posterioridad y anterioridad a este respecto en otras regiones del mundo, sólo piden que “las organizaciones tomen las medidas técnicas y organizativas apropiadas para proteger y securizar los datos”. De hecho, desde su entrada en vigor, hay mucha jurisprudencia que muestra cómo haber hecho uso de técnicas de cifrado o anonimización de los datos, no ha servido para evitar cuantiosas multas por incumplimiento de la normativa. Tanto es así, que se pueden llegar a encontrar recomendaciones de las Autoridades responsables del cumplimiento de estas normativas en cada país, en las que se aconseja bajo qué circunstancias NO es recomendable la utilización de cifrado, por los riesgos implícitos que su uso supone. Las empresas que venden soluciones de cifrado no te hablarán nunca de estos ejemplos.

Queda pues expuesta la débil correlación que hay entre cifrado y cumplimiento del deber de protección de los datos que establece la norma. Pero: ¿nos ayuda en la obligación que establece a efectos de notificación? (Artículo 34). La respuesta es: tampoco.

La GDPR establece la obligación de aplicar medidas de seguridad a los datos de forma que se mantenga un equilibrio entre el nivel de riesgo asumido (que debe estar medido), el tipo de dato protegido, y el coste de implementar las medidas. Asimismo, se debe informar a las Autoridades competentes y a los sujetos afectados, antes de un determinado plazo, cuando se haya producido una brecha de seguridad; la norma también establece la NO obligatoriedad de la notificación si se han adoptado unas medidas de protección adecuadas y si el resultado de dichas medidas es que los datos no pueden ser accedidos de manera inteligible por alguien que no esté autorizado. Y aquí está la “trampa”, puede sonar como que si has cifrado el dato, has tomado las “medidas de protección adecuadas” que te eximen de tu obligación…

Pero mucho ojo con esto último. Las Autoridades pueden recibir una denuncia de alguien afectado, o pueden realizar investigaciones de oficio cuando una determinada noticia salta a la prensa. Y la jurisprudencia ha demostrado que las multas no se evitan cuando se emplea el cifrado (como técnica), si ha sido implementada de una manera que no ha evitado que los datos hayan sido exfiltrados… ¿Y cómo es esto posible?, no quiero entrar en detalles técnicos, pero es muy fácil equivocarse si no se invierte en un proyecto sólido de protección del dato. Hablaba al principio de todos los proveedores de servicios cloud, y valga este ejemplo: todos ellos, sin excepción, cifran de manera nativa y por defecto sus repositorios de datos; y esto no ha evitado los robos de datos… porque la responsabilidad de cómo de bien se protegen estos datos, estén cifrados o no, sigue siendo del cliente y no del proveedor del servicio.

Otro matiz importante tiene que ver con la protección de las claves de cifrado. De todos es bien sabido que la mejor manera de borrar un dato encriptado es borrar la clave de cifrado… pero, ¿qué pasa si se pierde la clave (o si nos la roban)?, pues que con ella se pierde el dato. Y aquí radica quizás el mayor riesgo que asumimos al decidirnos por adoptar una estrategia de protección que usa el cifrado. Y este riesgo, muchas veces no está ponderado adecuadamente. Las claves son lo más sensible, y de ahí que un auditor se fije especialmente en cómo de sólido es nuestro proceso de gestión del ciclo de vida de dicha clave. Hacerlo adecuadamente va a requerir recursos extra, y un gran y escaso conocimiento técnico, del que no nos podemos olvidar.

Pero de nuevo, no caigamos en la trampa de pensar que cifrar es una labor simple. No sólo es elevado el conocimiento técnico necesario, lo será también nuestra capacidad para implementar esa función en toda la cadena IT que entra en contacto con los datos. La e-privacy regulation de la UE es la primera norma que establece explícitamente la recomendación de implantar soluciones de cifrado “extremo-a-extremo”; pero bien entendido que esta es una exigencia que aún se tiene que transponer a cada pais de la UE por medio de una nueva norma, y que sería de aplicación en todo caso a los proveedores de servicios electrónicos de comunicaciones.

Hasta aquí, algunas reflexiones que pienso que hay que considerar a la hora de decidir si nos conviene o no el cifrado; si de lo que se trata es de cumplir la norma, sea GDPR, sea cualquier otra, la fórmula más eficaz será función de cada entorno, pero en general: una descripción detallada y documentada de dónde están los datos a proteger, medidas que demuestren que se monitoriza el acceso a los mismos, y se detectan accesos fuera de la política establecida, debería ser suficiente. El riesgo que asumimos por implantar el cifrado de nuestros datos debe ser medido (y medible) antes de tomar una decisión.

[La GDPR, en castellano](https://www.boe.es/doue/2016/119/L00001-00088.pdf)

[Transposición de GDPR a España (RGPD)](https://www.boe.es/buscar/act.php?id=BOE-A-2018-10751)
